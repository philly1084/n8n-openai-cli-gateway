apiVersion: v1
kind: ConfigMap
metadata:
  name: n8n-openai-cli-gateway-config
data:
  providers.yaml: |
    providers:
      - id: gemini-cli
        type: cli
        description: Gemini via OpenCode + Google OAuth plugin
        models:
          - id: gemini-2.5-pro
            providerModel: google/gemini-2.5-pro
        responseCommand:
          executable: opencode
          args:
            - run
            - --model
            - "{{provider_model}}"
            - --format
            - default
            - "{{prompt}}"
          input: prompt_stdin
          output: text
          timeoutMs: 240000
        auth:
          loginCommand:
            executable: opencode
            args:
              - auth
              - login
            timeoutMs: 900000
          statusCommand:
            executable: sh
            args:
              - -c
              - opencode auth list | grep -qi google
            timeoutMs: 30000
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: n8n-openai-cli-gateway-opencode-config
data:
  opencode.json: |
    {
      "$schema": "https://opencode.ai/config.json",
      "plugin": ["opencode-gemini-auth@latest"]
    }
---
apiVersion: v1
kind: Secret
metadata:
  name: n8n-openai-cli-gateway-secrets
type: Opaque
stringData:
  n8nApiKey: replace-with-long-random-key
  adminApiKey: replace-with-long-random-admin-key
